<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Quantiles, Networks, Time - 3&nbsp; State-Space Models: time series models with structure</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./RegressionLemma.html" rel="next">
<link href="./R2021.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Methods matter</a></li><li class="breadcrumb-item"><a href="./ssm.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">State-Space Models: time series models with structure</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Quantiles, Networks, Time</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genesis</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Methods matter</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R2021.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Non-econometric methods for econometricians</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ssm.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">State-Space Models: time series models with structure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RegressionLemma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The regression lemma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Kalman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Kalman filtering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Unemp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plotting unemployment forecasts</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Quantiles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./QR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Quantile regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GDP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">GDP@Risk</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Gibbs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Gibbs Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CK.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Carter-Kohn</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SMH.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Metropolis-Hastings</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Networks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Stemp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Causal Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Mapping regional house price inflation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Time</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BK.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Linear rational expectations models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BVAR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">BVAR with dummies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Dynare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Dynare basics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">End matter</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Appendix1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Basic <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./LinAlg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Linear algebra</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">3.1</span> Introduction</a></li>
  <li><a href="#a-useful-class-of-models" id="toc-a-useful-class-of-models" class="nav-link" data-scroll-target="#a-useful-class-of-models"><span class="header-section-number">3.2</span> A useful class of models</a>
  <ul class="collapse">
  <li><a href="#unobserved-variables-and-coefficients" id="toc-unobserved-variables-and-coefficients" class="nav-link" data-scroll-target="#unobserved-variables-and-coefficients"><span class="header-section-number">3.2.1</span> Unobserved variables and coefficients</a></li>
  </ul></li>
  <li><a href="#dynamic-economic-models" id="toc-dynamic-economic-models" class="nav-link" data-scroll-target="#dynamic-economic-models"><span class="header-section-number">3.3</span> Dynamic economic models</a>
  <ul class="collapse">
  <li><a href="#general-state-space-model" id="toc-general-state-space-model" class="nav-link" data-scroll-target="#general-state-space-model"><span class="header-section-number">3.3.1</span> General state space model</a></li>
  </ul></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">3.4</span> Examples</a>
  <ul class="collapse">
  <li><a href="#structural-time-series-models-stsms" id="toc-structural-time-series-models-stsms" class="nav-link" data-scroll-target="#structural-time-series-models-stsms"><span class="header-section-number">3.4.1</span> Structural time series models (STSMs)</a></li>
  <li><a href="#trend-cycle-model" id="toc-trend-cycle-model" class="nav-link" data-scroll-target="#trend-cycle-model"><span class="header-section-number">3.4.2</span> Trend-cycle model</a></li>
  <li><a href="#time-varying-parameters-tvp" id="toc-time-varying-parameters-tvp" class="nav-link" data-scroll-target="#time-varying-parameters-tvp"><span class="header-section-number">3.4.3</span> Time-varying parameters (TVP)</a></li>
  <li><a href="#dynamic-factor-model" id="toc-dynamic-factor-model" class="nav-link" data-scroll-target="#dynamic-factor-model"><span class="header-section-number">3.4.4</span> Dynamic factor model</a></li>
  <li><a href="#var" id="toc-var" class="nav-link" data-scroll-target="#var"><span class="header-section-number">3.4.5</span> VAR</a></li>
  <li><a href="#multiple-representations-arma11" id="toc-multiple-representations-arma11" class="nav-link" data-scroll-target="#multiple-representations-arma11"><span class="header-section-number">3.4.6</span> Multiple representations: ARMA(1,1)</a></li>
  <li><a href="#dsge-model" id="toc-dsge-model" class="nav-link" data-scroll-target="#dsge-model"><span class="header-section-number">3.4.7</span> DSGE model</a></li>
  </ul></li>
  <li><a href="#estimation-problem" id="toc-estimation-problem" class="nav-link" data-scroll-target="#estimation-problem"><span class="header-section-number">3.5</span> Estimation problem</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">State-Space Models: time series models with structure</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">3.1</span> Introduction</h2>
<p>What is (a) state space (model) and why do we use it? Here we</p>
<ul>
<li>explain the model form (and explain what state space is);</li>
<li>discuss the reasons for using them.</li>
</ul>
<p>This is best illustrated by discussing a number of example models and applications. We will also explore what this implies for estimation.</p>
<p>The standard textbook for this is <span class="citation" data-cites="Harvey89">Harvey (<a href="references.html#ref-Harvey89" role="doc-biblioref">1989</a>)</span> (which understandably feels a little dated both in terms of content and notation) as well as <span class="citation" data-cites="Hamilton1994">Hamilton (<a href="references.html#ref-Hamilton1994" role="doc-biblioref">1994</a>)</span>, <span class="citation" data-cites="Durbin">Durbin and Koopman (<a href="references.html#ref-Durbin" role="doc-biblioref">2001</a>)</span> and <span class="citation" data-cites="KimNelson">Kim and Nelson (<a href="references.html#ref-KimNelson" role="doc-biblioref">1999</a>)</span>. Each of these have numerous classical and Bayesian applications and extensions.</p>
</section>
<section id="a-useful-class-of-models" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="a-useful-class-of-models"><span class="header-section-number">3.2</span> A useful class of models</h2>
<p>State-space models are a useful framework amenable to both classical and Bayesian estimation. Their set-up encompasses a number of common economic models with interesting features such as time variation or unobserved components. In either case this implies we need to estimate unknown values of a time series.</p>
<p>Model form is quite general but has multiple interpretations and is <em>often not unique</em>. There is also quite a lot of additional apparatus required before we can apply either maximum likelihood estimation or Gibbs sampling.</p>
<section id="unobserved-variables-and-coefficients" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="unobserved-variables-and-coefficients"><span class="header-section-number">3.2.1</span> Unobserved variables and coefficients</h3>
<p>A lot of <strong><em>quantities</em></strong> that we routinely use to build models and analyse policy are <strong><em>unobservable</em></strong>: often correspond to concepts with economic meaning rather than being inherently measurable, e.g.:</p>
<ul>
<li>Business cycle or output gap, natural rate of interest, persistent exogenous shocks such as productivity or preferences</li>
<li>Other models have latent variables with no clear interpretation: popular procedure to reduce large data sets to dynamic factors</li>
</ul>
<p>Alternatively we might be interested in models with <strong><em>time-varying parameters</em></strong>:</p>
<ul>
<li>Contrasting examples are models with slowly evolving parameters or with regime switches;</li>
<li>The coefficients of these models are both unobserved and (potentially) time-varying;</li>
</ul>
<p>Econometricians face major problems estimating such models: the set up is complicated and data requirements may be excessive. Fortunately there is a method we can use to estimate where we are (‘the state’ of state space) given available observable data.</p>
<p>The estimation method we usually use is the <strong><em>Kalman filter</em></strong>, see <span class="citation" data-cites="Kalman">Kalman (<a href="references.html#ref-Kalman" role="doc-biblioref">1960</a>)</span>. As an estimation process, this has the useful spin-off that we can also use it to calculate the value of the likelihood function at the same time.</p>
</section>
</section>
<section id="dynamic-economic-models" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="dynamic-economic-models"><span class="header-section-number">3.3</span> Dynamic economic models</h2>
<p>Consider a first order VAR (we’ll show how this isn’t restrictive) <span class="math display">\[
     x_t = \mu + A x_{t-1} + v_t
\]</span> with <span class="math inline">\(v_t\sim N(0,Q)\)</span>. Estimation of this model is easy – actually very easy as the unrestricted <span class="math inline">\(A\)</span> matrix means we can use OLS (the proof of this is left as an exercise…). Instead we augment this with a second set of equations to turn it into a system where we map the data to the state <span class="math display">\[
    \overbrace{y_t}^{Data} = \overbrace{x_t}^{State}
\]</span> This reflects an important characteristic of state space models: all data needs to be fed into the model through <strong><em>observation equations</em></strong>. This seems an odd way to go about estimating a VAR: but we now generalize this to allow that for variables we <strong><em>can’t</em></strong> see.</p>
<section id="general-state-space-model" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="general-state-space-model"><span class="header-section-number">3.3.1</span> General state space model</h3>
<p>State space models consist of two sets of equations: (1) <strong><em>Observation</em></strong> equations and (2) <strong><em>State</em></strong> or <strong><em>Transition</em></strong> equations. The classical Kalman filter set up might be:</p>
<ul>
<li>Observation equations <span class="math display">\[
\overbrace{y_t}^{Data} = \underbrace{H}_{Coefficients}  \overbrace{\beta_t}^{State} +\ e_t
\]</span></li>
<li>State/Transition equations <span class="math display">\[
\beta_t = \mu + F\beta_{t-1} + v_t
\]</span></li>
</ul>
<p>We assume <span class="math inline">\(v_t\sim N(0,Q)\)</span>, <span class="math inline">\(e_t\sim N(0,R)\)</span> and <span class="math inline">\(cov(e_t,v_t)=0\)</span>. Set up like this, coefficients of <span class="math inline">\(H\)</span> are akin to linear regression parameters. Even more generally there could be further coefficients i.e.&nbsp;<span class="math inline">\(y_t = H \beta_t + B e_t\)</span>.</p>
<p>Now consider the following variation <span class="math display">\[
    \begin{align*}
    y_t    &amp;= \underbrace{H_t}_{Data} \beta_t + e_t \\
     \beta_t &amp;= \mu + F \beta_{t-1} + v_t
    \end{align*}
\]</span> This allows <span class="math inline">\(H_t\)</span> to <em>potentially</em> vary through time; written like this we can think of <span class="math inline">\(H_t\)</span> as data and <span class="math inline">\(\beta_t\)</span> as the regression parameters. For the time being consider <span class="math inline">\(F\)</span> and <span class="math inline">\(\mu\)</span> to be time-invariant and the disturbances to have constant variances, although we can easily generalize this.</p>
<p>Written one way the measurement equation is familiar from our understanding of regression models; written another it looks like a time-varying parameter model. The state equation is familiar from our analysis of dynamic macromodels but here looks more like a potential dynamic process for the regression coefficients to vary through time. One big difference is the combination of the two. In particular, this formalizes the role of ‘signal’ – <span class="math inline">\(v_t\)</span> – and ‘noise’ – <span class="math inline">\(e_t\)</span>.</p>
<p>Model allows for the possibility that we neither directly observe the ‘driving’ variables of the system nor do we measure them accurately. To make sense of state space it is convenient to look at a variety of example models.</p>
</section>
</section>
<section id="examples" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="examples"><span class="header-section-number">3.4</span> Examples</h2>
<section id="structural-time-series-models-stsms" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="structural-time-series-models-stsms"><span class="header-section-number">3.4.1</span> Structural time series models (STSMs)</h3>
<p>Alternative time series decomposition associated with <span class="citation" data-cites="Harvey89">Harvey (<a href="references.html#ref-Harvey89" role="doc-biblioref">1989</a>)</span>. Suggests instead that economic time series might be split into <span class="math display">\[
    \begin{align}
    y_t &amp;=\mu_t + e_t     &amp;e_t\sim N\left(0,\sigma_v^2\right) \\
    \mu_t &amp;=\mu_{t-1}+\lambda_{t-1}+\xi_t   &amp;\xi_t\sim N\left(0,\sigma_\xi^2\right) \\
    \lambda_t &amp;=\lambda_{t-1}+\zeta_t   &amp;\zeta_t\sim N\left(0,\sigma_\zeta^2 \right)
    \end{align}
\]</span> This is known as the <strong><em>local linear trend</em></strong> model. Both the trend level and slope can vary over time.</p>
<p>In state space this is: <span class="math display">\[
    \begin{align}
    y_t &amp;= \overset{H}{\begin{bmatrix} 1 &amp; 0 \end{bmatrix}}
    \overset{\beta_t}{\begin{bmatrix}\mu_t \\ \lambda_t \end{bmatrix} } + e_{t} \\
    \overset{\beta_t}{\begin{bmatrix}\mu_t \\ \lambda_t \end{bmatrix}} &amp;=
    \overset{F}{\begin{bmatrix} 1 &amp; 1 \\  0 &amp; 1 \end{bmatrix}}
    \overset{\beta_{t-1}}{\begin{bmatrix}\mu_{t-1} \\ \lambda_{t-1} \end{bmatrix}} +
    \begin{bmatrix} \xi_t \\ \zeta_t\end{bmatrix}
    \end{align}
\]</span> The only parameters of this model that we need to estimate are the variances.</p>
</section>
<section id="trend-cycle-model" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="trend-cycle-model"><span class="header-section-number">3.4.2</span> Trend-cycle model</h3>
<p>What if we wanted to decompose GDP into a trend and a cycle. Let observed GDP be modeled as: <span class="math display">\[
    y_t = \chi_t + \tau_t
    \]</span> where the cycle <span class="math inline">\(\chi_t\)</span> is an <span class="math inline">\(AR(2)\)</span> process and the trend <span class="math inline">\(\tau_t\)</span> a random walk <span class="math display">\[
    \begin{align}
    \chi_t &amp;= c + \rho_1 \chi_{t-1} + \rho_2 \chi_{t-2} + v_{1t} \\
    \tau_t &amp;= \tau_{t-1} + v_{2t}
    \end{align}
\]</span> In state space form this is: <span class="math display">\[
    \begin{align}
    y_{t}&amp; =\overset{H}{\left[\begin{array}{ccc} 1 &amp; 0 &amp; 1 \end{array} \right] }
    \overset{\beta_t} {\left[ \begin{array}{c} \chi_t \\  \chi_{t-1} \\ \tau_t  \end{array} \right] } \\
    \overset{\beta_t} {\left[\begin{array}{c} \chi_t \\  \chi_{t-1} \\ \tau_t \end{array}\right] }
    &amp; =\overset{\mu }{\left[\begin{array}{c} c \\  0 \\  0 \end{array} \right] } +
        \overset{F} {\left[\begin{array}{ccc} \rho_1 &amp; \rho_2 &amp; 0 \\
    1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 1
    \end{array}
    \right] }\overset{\beta_{t-1}}{\left[
    \begin{array}{c}
    \chi_{t-1} \\
    \chi_{t-2} \\
    \tau_{t-1}  
    \end{array}
    \right] }+\left[
    \begin{array}{c}
    v_{1t} \\
    0 \\
    v_{2t}
    \end{array}
    \right]
    \end{align}
\]</span> where <span class="math inline">\(R=0\)</span> (there is no measurement error) and <span class="math inline">\(H\)</span> is time invariant</p>
</section>
<section id="time-varying-parameters-tvp" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="time-varying-parameters-tvp"><span class="header-section-number">3.4.3</span> Time-varying parameters (TVP)</h3>
<p>Sometimes we wish to model structural change by incorporating time-varying parameters. From the equations above we could set this up as <span class="math display">\[\begin{align*}
    y_t     &amp;= H_t \beta_t + e_t \\
    \beta_t &amp;= \beta_{t-1} + v_t
    \end{align*}\]</span> The time-varying coefficients (<span class="math inline">\(\beta_t\)</span>) multiply a vector of time-varying regressors (<span class="math inline">\(H_t\)</span>). As the data is fixed the distribution of <span class="math inline">\(\beta_t\)</span> will be conditionally normal if all the errors are normal.</p>
<p>We set <span class="math inline">\(F=I\)</span> so the parameters are assumed to follow a random walk and the steady-state variance of <span class="math inline">\(\beta_t\)</span> is infinite. The model becomes time-invariant with <span class="math inline">\(\beta=\beta_0\)</span> if <span class="math inline">\(Q = (\sigma_{\nu}^2=)\ 0\)</span>. We now explicitly write the simplest TVP model <span class="math display">\[
    y_t = c_t + X_t B_t + e_t
\]</span> where <span class="math inline">\(c_t\)</span> and <span class="math inline">\(B_t\)</span> both follow a random walk. In state space form <span class="math display">\[
    \begin{align}
    y_t &amp;= \overset{H_t} {\begin{bmatrix} 1 &amp; X_t \end{bmatrix} }
     \overset{\beta_t} {\begin{bmatrix} c_t \\ B_t \end{bmatrix} } + e_t &amp; var(e) = R \\
     \overset{\beta_t} {\begin{bmatrix} c_t \\ B_t \end{bmatrix} } &amp;=
     \overset{\beta_{t-1}} {\begin{bmatrix} c_{t-1} \\  B_{t-1} \end{bmatrix}}
     + \begin{bmatrix} v_{1t} \\ v_{2t} \end{bmatrix} &amp; var(v) = Q
    \end{align}
\]</span> where <span class="math inline">\(F=I\)</span> and <span class="math inline">\(\mu=0\)</span>. As <span class="math inline">\(\sigma_{\nu}^2 \neq 0\)</span> the coefficients aren’t fixed even though <span class="math inline">\(F=I\)</span>.</p>
</section>
<section id="dynamic-factor-model" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="dynamic-factor-model"><span class="header-section-number">3.4.4</span> Dynamic factor model</h3>
<p>Assume a panel of series <span class="math inline">\(y_{it}\)</span> has a common component <span class="math inline">\(f_t\)</span> <span class="math display">\[
\begin{align}
    y_{it} &amp;= B_i f_t + e_{it}, \qquad &amp;i=1,\ldots ,N \\
    f_t    &amp;= c+\rho_1 f_{t-1} + \rho_2 f_{t-2} + v_t
\end{align}
\]</span> In state space form <span class="math display">\[
    \begin{align*}
    \left[
    \begin{array}{c}y_{1t} \\ y_{2t} \\ \vdots \\ y_{Nt}\end{array}\right] &amp;=
    \overset{H}{\left[ \begin{array}{cc}B_1 &amp; 0 \\ B_2 &amp; 0 \\ \vdots &amp; \vdots \\ B_N &amp; 0\end{array}\right] }
    \overset{\beta_t}{\left[ \begin{array}{c}f_t \\ f_{t-1} \end{array}\right] } + \left[ \begin{array}{c} e_{1t} \\ e_{2t} \\ \vdots \\ e_{Nt} \end{array}\right] \\
    \overset{\beta_t}{\left[ \begin{array}{c} f_t  \\ f_{t-1} \end{array}\right] } &amp;=
    \overset{\mu }{\left[  \begin{array}{c}c \\ 0 \end{array} \right] }+
    \overset{F}{\left[ \begin{array}{cc}
    \rho_1 &amp; \rho_2 \\  1 &amp; 0 \end{array} \right] }
    \overset{\beta_{t-1}}{\left[  \begin{array}{c} f_{t-1} \\ f_{t-2} \end{array} \right] }+\left[ \begin{array}{c} v_t \\ 0\end{array}
    \right]
    \end{align*}
\]</span> - The factors have dynamics but the observed variables do not</p>
</section>
<section id="var" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="var"><span class="header-section-number">3.4.5</span> VAR</h3>
<p>At a more abstract level, a <span class="math inline">\(k\)</span>-variable, <span class="math inline">\(p\)</span>-lag VAR <span class="math display">\[
  X_t = c + \sum_{i=1}^p A_i X_{t-i} + \varepsilon_t,\quad\hbox{where}\ Y_t = X_t
\]</span> This can always be written <span class="math display">\[
    \begin{align*}
    Y_t &amp;=
    \overset{H}{\left[ I \ 0 \  ...\right] }
    \overset{\beta_t}{\left[ \begin{array}{c}X_t \\ X_{t-1} \\ \vdots\end{array}\right] } \\
    \overset{\beta_t}{\left[ \begin{array}{c} X_t  \\ X_{t-1} \\ \vdots \end{array}\right] } &amp;=
    \overset{\mu}{\left[  \begin{array}{c}c \\ 0 \\ \vdots\end{array} \right] }+
    \overset{F}{\left[ \begin{array}{ccc}
    A_1 &amp; A_2 &amp; \ldots \\  I &amp; 0 &amp; \ldots \\ \vdots &amp; \vdots &amp; \ddots \end{array} \right] }
    \overset{\beta_{t-1}}{\left[ \begin{array}{c}X_{t-1} \\ X_{t-2} \\ \vdots\end{array}\right] } +
    \left[ \begin{array}{c} \varepsilon_t \\ 0 \\ \vdots\end{array}
    \right]
    \end{align*}
\]</span> This is an important example: this model has entirely observed variables. The size of the resulting state is <span class="math inline">\(p\times k\)</span>, potentially quite large: however written this way the model is easy to simulate.</p>
<p>We can ask the question: can we find <strong><em>unobserved</em></strong> variables that preserve the properties of <span class="math inline">\(Y_t\)</span>? What if: <span class="math display">\[
     Y_t = X_t = P \tilde X_t
\]</span> then <span class="math display">\[
    \tilde X_t = P^{-1}A P \tilde X_{t-1} + P^{-1} \varepsilon_t = \tilde A \tilde X_{t-1} + \tilde \varepsilon_t
\]</span> This shows that the state space representation is not unique.</p>
</section>
<section id="multiple-representations-arma11" class="level3" data-number="3.4.6">
<h3 data-number="3.4.6" class="anchored" data-anchor-id="multiple-representations-arma11"><span class="header-section-number">3.4.6</span> Multiple representations: ARMA(1,1)</h3>
<p>This reflects the fact that model representations in general are not unique. For example, two representations of <span class="math display">\[
    y_t = \phi y_{t-1} + \varepsilon_t + \theta \varepsilon_{t-1}  
\]</span> This can be written either as <span class="math display">\[
    y_t = \left[ 1 \ 0\right]  \left[ \begin{array}{c}y_t \\ \varepsilon_t \end{array}\right], \qquad
    \left[ \begin{array}{c} y_t  \\ \varepsilon_t \end{array}\right]  =
    \left[ \begin{array}{ccc} \phi &amp; \theta \\ 0 &amp; 0 \end{array} \right]
    \left[ \begin{array}{c}y_{t-1} \\ \varepsilon_{t-1} \end{array}\right]   +
    \left[ \begin{array}{c} 1 \\ 1 \end{array} \right] \varepsilon_t
\]</span> or <span class="math display">\[
    y_t = \begin{bmatrix} 1 &amp; 0 \end{bmatrix} \begin{bmatrix} y_t \\ \theta\varepsilon_t \end{bmatrix}, \qquad
    \begin{bmatrix} y_t  \\ \theta\varepsilon_t \end{bmatrix} =
    \begin{bmatrix} \phi &amp; 1 \\ 0 &amp; 0 \end{bmatrix}
    \begin{bmatrix} y_{t-1} \\ \theta\varepsilon_{t-1} \end{bmatrix} +
    \begin{bmatrix} 1 \\ \theta \end{bmatrix} \varepsilon_t
\]</span></p>
</section>
<section id="dsge-model" class="level3" data-number="3.4.7">
<h3 data-number="3.4.7" class="anchored" data-anchor-id="dsge-model"><span class="header-section-number">3.4.7</span> DSGE model</h3>
<p>Take a simple New Keynesian model <span class="math display">\[\begin{align}
y_t    &amp;= y_{t+1}^e-\frac{1}{\sigma} (i_t - \pi_{t+1}^e) + e_t^1 \\
\pi_t  &amp;= \beta \pi_{t+1}^e + \kappa y_t + e_t^2 \\
i_t    &amp;= \gamma i_{t-1} + (1-\gamma) \delta \pi_t + \varepsilon_t^3 \\
e_t^1  &amp;= \rho_1 e_{t-1}^1 + \varepsilon_t^1 \\
e_t^2  &amp;= \rho_2 e_{t-1}^2 + \varepsilon_t^2
\end{align}\]</span> The model comprises a dynamic IS curve, a Phillips Curve and a policy rule with smoothing. There are three shocks, two of which are persistent. This we need to write in the general algebraic linear state-space form: <span class="math display">\[
E\begin{bmatrix} z_t \\ x_{t+1}^e \end{bmatrix} = A \begin{bmatrix} z_{t-1} \\ x_t \end{bmatrix} + B \varepsilon_t  
\]</span> We map our variables to their algebraic equivalent as (<span class="math inline">\(z_t\)</span>, <span class="math inline">\(x_t\)</span>) <span class="math inline">\(=\)</span> ((<span class="math inline">\(e^1_t\)</span>, <span class="math inline">\(e^2_t\)</span>, <span class="math inline">\(i_t\)</span>), (<span class="math inline">\(y_t\)</span>, <span class="math inline">\(\pi_t\)</span>)). Then the model in state-space form but including the matrix <span class="math inline">\(E\)</span> is <span class="math display">\[
\begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
                0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
                0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
                1 &amp; 0 &amp; -\frac{1}{\sigma} &amp; 1 &amp; \frac{1}{\sigma} \\
                0 &amp; 1 &amp; 0 &amp; 0 &amp; \beta
\end{bmatrix}
\begin{bmatrix} e^1_t \\ e^2_t \\ i_t \\ y^e_{t+1} \\ \pi^e_{t+1} \end{bmatrix}
   =
   \begin{bmatrix} \rho_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
                0 &amp; \rho_2 &amp; 0 &amp; 0 &amp; 0 \\
                0 &amp; 0 &amp; \gamma &amp; 0 &amp; (1-\gamma)\delta \\
                0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
                0 &amp; 0 &amp; 0 &amp; -\kappa &amp; 1
   \end{bmatrix}
\begin{bmatrix} e^1_{t-1} \\ e^2_{t-1} \\ i_{t-1} \\ y_t \\ \pi_t \end{bmatrix}    
   +
      \begin{bmatrix}
                1 &amp; 0 &amp; 0  \\
                0 &amp; 1 &amp; 0 \\
                0 &amp; 0 &amp; 1 \\
                0 &amp; 0 &amp; 0 \\
                0 &amp; 0 &amp; 0
   \end{bmatrix}
   \begin{bmatrix} \varepsilon^1_t \\ \varepsilon^2_t \\ \varepsilon^3_t \end{bmatrix}    
\]</span> As the left matrix is invertible we can write this in the form <span class="math display">\[
\begin{bmatrix} z_t \\ x_{t+1}^e \end{bmatrix} = C \begin{bmatrix} z_{t-1} \\ x_t \end{bmatrix} + D \varepsilon_t  
\]</span> where <span class="math inline">\(C = E^{-1}A\)</span>, <span class="math inline">\(D=E^{-1}B\)</span>. However, even in this form it doesn’t quite conform to the standard state space model. This is because we retain the expectations in the model. Typically we need to solve the model for the expectations using the <span class="citation" data-cites="BK1980">(<a href="references.html#ref-BK1980" role="doc-biblioref"><strong>BK1980?</strong></a>)</span> method or similar such that <span class="math display">\[
x_t = -N z_{t-1} - G \varepsilon_t
\]</span> Substituting this in we get a final state-space form <span class="math display">\[\begin{align}
\begin{bmatrix} z_t \\ x_t \end{bmatrix} &amp;= \begin{bmatrix} C_{11} - C_{12}N &amp; 0 \\ -N &amp; 0 \end{bmatrix} \begin{bmatrix} z_{t-1} \\ x_{t-1} \end{bmatrix} + \begin{bmatrix} D_1-C_{12}G \\ -G \end{bmatrix} \varepsilon_t \\
&amp;= P \begin{bmatrix} z_{t-1} \\ x_{t-1} \end{bmatrix} + Q \varepsilon_t
\end{align}\]</span> This needs to be augmented with an observation equation, perhaps <span class="math display">\[
\begin{bmatrix} i_t \\ y_t \\ \pi_t \end{bmatrix}
= \begin{bmatrix} 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
                0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
                0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix} e^1_t \\ e^2_t \\ i_t \\ y_t \\ \pi_t \end{bmatrix}
\]</span> where we don’t observe the autoregressive shocks.</p>
</section>
</section>
<section id="estimation-problem" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="estimation-problem"><span class="header-section-number">3.5</span> Estimation problem</h2>
<p>Recall the observation equation and transition equations <span class="math display">\[
    \begin{align}
    y_t       &amp;= H\beta_t + e_t,         &amp;var(e_t)=R \\
    \beta_t   &amp;= \mu + F\beta_{t-1}+v_t  &amp;var(v_t)=Q
    \end{align}
\]</span> where here we treat <span class="math inline">\(H\)</span> as time invariant.</p>
<p>Notice that at least some parameters of the state space model (<span class="math inline">\(H\)</span>, <span class="math inline">\(\mu\)</span>, <span class="math inline">\(F\)</span>, <span class="math inline">\(R\)</span> and <span class="math inline">\(Q\)</span>) and the state variables (<span class="math inline">\(\beta_t\)</span>) are both unknown. <strong><em>Simultaneous</em></strong> estimation of both sets of unknowns is usually required. This is usually approached iteratively, with the unknown state estimated conditional on some initial estimate of the parameters (or in the Bayesian case <em>sampled</em>) using an appropriate method, usually the <em>Kalman Filter</em> and then then the parameters updated conditional on the state which is repeated until convergence. This can be done using Gibb’s Sampling if we can derive the a conditional density for the unobserved components.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Durbin" class="csl-entry" role="listitem">
Durbin, J., and S. J. Koopman. 2001. <em>Time Series Analysis by State Space Methods</em>. Oxford: Oxford University Press.
</div>
<div id="ref-Hamilton1994" class="csl-entry" role="listitem">
Hamilton, J. D. 1994. <em>Time Series Analysis</em>. Princeton, NJ: Princeton University Press.
</div>
<div id="ref-Harvey89" class="csl-entry" role="listitem">
Harvey, Andrew C. 1989. <em>Forecasting, Structural Time Series Models and the Kalman Filter</em>. Cambridge: Cambridge University Press.
</div>
<div id="ref-Kalman" class="csl-entry" role="listitem">
Kalman, R. E. 1960. <span>“A New Approach to Linear Filtering and Prediction Problems.”</span> <em>Transactions of the ASME Journal of Basic Engineering</em> 82 (Series D): 35–45.
</div>
<div id="ref-KimNelson" class="csl-entry" role="listitem">
Kim, Chang-Jin, and Charles R. Nelson. 1999. <em>State-Space Models with Regime Switching: Classical and Gibbs-Sampling Approaches with Applications</em>. MIT Press.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./R2021.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Non-econometric methods for econometricians</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./RegressionLemma.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The regression lemma</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>